<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Loading</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #2a2a2a;
        }
        .success { border-left: 4px solid #10b981; }
        .error { border-left: 4px solid #ef4444; }
        .info { border-left: 4px solid #3b82f6; }
        pre {
            background: #000;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –î–∞–Ω–∏—Ö</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        async function runTests() {
            log('–ü–æ—á–∞—Ç–æ–∫ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è...', 'info');

            // Test 1: Fetch events.json
            try {
                log('–¢–µ—Å—Ç 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è data/events.json...', 'info');
                const response = await fetch('data/events.json');
                log(`–°—Ç–∞—Ç—É—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úì JSON —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑–ø–∞—Ä—Å–µ–Ω–æ. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–¥—ñ–π: ${data.length}`, 'success');
                    log(`–ü–µ—Ä—à–∞ –ø–æ–¥—ñ—è: <pre>${JSON.stringify(data[0], null, 2)}</pre>`, 'info');
                    
                    // Test if events have coordinates
                    const eventsWithCoords = data.filter(e => e.lat && e.lng).length;
                    const eventsWithoutCoords = data.length - eventsWithCoords;
                    log(`–ü–æ–¥—ñ—ó –∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏: ${eventsWithCoords}`, eventsWithCoords > 0 ? 'success' : 'info');
                    log(`–ü–æ–¥—ñ—ó –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç: ${eventsWithoutCoords}`, eventsWithoutCoords > 0 ? 'info' : 'success');
                    
                    if (eventsWithoutCoords > 0) {
                        log('‚ö†Ô∏è –î–µ—è–∫—ñ –ø–æ–¥—ñ—ó –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç. –§—É–Ω–∫—Ü—ñ—è enhanceEventData() –¥–æ–¥–∞—Å—Ç—å —ó—Ö.', 'info');
                    }
                } else {
                    log(`‚úó –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚úó –ü–æ–º–∏–ª–∫–∞: ${error.message}`, 'error');
                log(`Stack: <pre>${error.stack}</pre>`, 'error');
            }

            // Test 2: Check Leaflet
            log('–¢–µ—Å—Ç 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Leaflet.js...', 'info');
            if (typeof L !== 'undefined') {
                log('‚úì Leaflet.js –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'success');
            } else {
                log('‚úó Leaflet.js –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'error');
            }

            // Test 3: Check Chart.js
            log('–¢–µ—Å—Ç 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Chart.js...', 'info');
            if (typeof Chart !== 'undefined') {
                log('‚úì Chart.js –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'success');
            } else {
                log('‚úó Chart.js –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'error');
            }

            log('–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'success');
        }

        // Wait for libraries to load
        setTimeout(runTests, 1000);
    </script>

    <!-- Load dependencies -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</body>
</html>
